FROM node:18-alpine

WORKDIR /app

COPY just-plan/package.json just-plan/yarn.lock ./

RUN yarn install

COPY just-plan/ ./

# 빌드 인자로 환경 변수 추가
ARG NEXT_PUBLIC_GOOGLEMAP_API_KEY
ARG NEXT_PUBLIC_KAKAO_API_KEY
ARG NEXT_PUBLIC_KAKAO_RESTAPI_KEY


# 빌드 시 환경 변수 사용
ENV NEXT_PUBLIC_GOOGLEMAP_API_KEY=$NEXT_PUBLIC_GOOGLEMAP_API_KEY
ENV NEXT_PUBLIC_KAKAO_API_KEY=$NEXT_PUBLIC_KAKAO_API_KEY
ENV NEXT_PUBLIC_KAKAO_RESTAPI_KEY=$NEXT_PUBLIC_KAKAO_RESTAPI_KEY

RUN yarn build

EXPOSE 3000

CMD ["yarn", "start"]